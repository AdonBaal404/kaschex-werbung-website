<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>KASCHEX – Profi-Angebotsrechner</title>
  <link rel="stylesheet" href="style.css">
  <style>
    header {
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      background: linear-gradient(-45deg, var(--brand), var(--brand-dark), #0b2342, #002a44);
      background-size: 400% 400%;
      animation: gradientMove 20s ease infinite;
      color: var(--text);
      padding: 2rem 1rem;
    }

    header h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: var(--brand-light);
    }

    header p {
      margin-bottom: 2rem;
      color: var(--muted);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1rem;
      width: 100%;
      max-width: 980px;
    }

    .card {
      background: var(--glass-bg);
      border-radius: var(--radius);
      padding: 1.5rem;
      box-shadow: var(--shadow);
      text-align: left;
    }

    .card h2 {
      font-size: 1.1rem;
      margin-bottom: .6rem;
      color: var(--brand);
    }

    label {
      display: block;
      font-size: .9rem;
      margin: .5rem 0 .25rem 0;
      color: var(--muted);
    }

    input, select {
      width: 100%;
      padding: .6rem .7rem;
      border-radius: 10px;
      border: 1px solid #1f2a37;
      background: #0f172a;
      color: var(--text);
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: .6rem;
    }

    .btns {
      display: flex;
      gap: .6rem;
      flex-wrap: wrap;
      margin-top: .8rem;
    }

    button {
      appearance: none;
      border: 0;
      border-radius: 12px;
      padding: .7rem 1rem;
      font-weight: 600;
      cursor: pointer;
    }

    .primary { background: var(--brand); color: #00131f; }
    .ghost   { background: #0f172a; color: var(--text); border: 1px solid #1f2a37; }
    .danger  { background: var(--err); color: #fff; }

    .totals {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .kpi {
      background: #0f172a;
      border: 1px solid #1f2a37;
      border-radius: 12px;
      padding: 1rem;
    }

    .kpi h3 {
      font-size: .95rem;
      color: var(--muted);
    }

    .kpi b {
      display: block;
      font-size: 1.4rem;
      margin-top: .2rem;
    }

    .mono { font-family: monospace; }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      background: #020617;
      color: #64748b;
      font-size: .9rem;
    }
  </style>
</head>
<body>

  <header>
    <h1>Profi-Angebotsrechner</h1>
    <p>Alle Parameter & Details sichtbar – präzise Kalkulation für Profis.</p>

    <div class="grid" role="region" aria-label="Kalkulation">
      <!-- Geometrie & Zeit -->
      <section class="card">
        <h2>1) Geometrie & Zeit</h2>
        <label for="area">Fläche A [m²]</label>
        <input id="area" type="number" step="0.1" value="5">

        <div class="row">
          <div>
            <label for="rate">Stundensatz c_h [€/h]</label>
            <input id="rate" type="number" value="65">
          </div>
          <div>
            <label for="speed">Leistung v [m²/h]</label>
            <input id="speed" type="number" value="3">
          </div>
        </div>

        <div class="row">
          <div>
            <label for="tprep">Rüstzeit [h]</label>
            <input id="tprep" type="number" value="0.5">
          </div>
          <div>
            <label for="ttravel">Anfahrt [h]</label>
            <input id="ttravel" type="number" value="0.5">
          </div>
        </div>

        <div class="btns">
          <button class="ghost" id="btnTime" type="button">Montagezeit schätzen</button>
          <button class="ghost" id="btnResetTime" type="button">Zeit zurücksetzen</button>
        </div>

        <label for="tmanual">Montagezeit manuell [h]</label>
        <input id="tmanual" type="number" placeholder="optional">
      </section>

      <!-- Material & Kosten -->
      <section class="card">
        <h2>2) Material & Fixkosten</h2>
        <div class="row">
          <div>
            <label for="cfolie">Folienkosten [€/m²]</label>
            <input id="cfolie" type="number" value="18">
          </div>
          <div>
            <label for="clam">Laminat [€/m²]</label>
            <input id="clam" type="number" value="6">
          </div>
        </div>

        <div class="row">
          <div>
            <label for="waste">Verschnitt [%]</label>
            <input id="waste" type="number" value="10">
          </div>
          <div>
            <label for="cfix">Fixkosten [€]</label>
            <input id="cfix" type="number" value="25">
          </div>
        </div>

        <div class="row">
          <div>
            <label for="alpha">Risiko α [%]</label>
            <input id="alpha" type="number" value="10">
          </div>
          <div>
            <label for="beta">Marge β [%]</label>
            <input id="beta" type="number" value="35">
          </div>
        </div>

        <div class="row">
          <div>
            <label for="gamma">Express γ [%]</label>
            <input id="gamma" type="number" value="0">
          </div>
          <div>
            <label for="mwst">MwSt [%]</label>
            <input id="mwst" type="number" value="19">
          </div>
        </div>
      </section>

      <!-- Ergebnis -->
      <section class="card">
        <h2>3) Ergebnis</h2>
        <div class="totals">
          <div class="kpi">
            <h3>Netto</h3>
            <b id="kNetto" class="mono">– €</b>
          </div>
          <div class="kpi">
            <h3>Brutto</h3>
            <b id="kBrutto" class="mono">– €</b>
          </div>
        </div>

        <div class="kpi" style="margin-top:1rem;">
          <h3>Details</h3>
          <pre id="breakdown" class="mono" style="white-space:pre-wrap;margin-top:.5rem"></pre>
        </div>

        <div class="btns">
          <button class="primary" id="btnCalc" type="button">Kalkulieren</button>
          <button class="ghost" id="btnQuote" type="button">Kurz-Angebot kopieren</button>
          <button class="danger" id="btnClear" type="button">Alles leeren</button>
        </div>
      </section>
    </div>
  </header>

  <footer>
    © KASCHEX WERBUNG · Diese Kalkulation ist unverbindlich.
  </footer>

  <script>
    (function(){
      "use strict";
      function g(id){return document.getElementById(id)}
      function round2(x){return Math.round((x+Number.EPSILON)*100)/100}
      function estTime(a,v,tr,ta){return v<=0?0:(a/v+tr+ta)}

      function compute(){
        const A = parseFloat(g("area").value)||0;
        const ch= parseFloat(g("rate").value)||0;
        const v = parseFloat(g("speed").value)||1;
        const tr= parseFloat(g("tprep").value)||0;
        const ta= parseFloat(g("ttravel").value)||0;
        const tMan=g("tmanual").value.trim();
        const tmont=tMan?parseFloat(tMan):estTime(A,v,tr,ta);

        const cFol=parseFloat(g("cfolie").value)||0;
        const cLam=parseFloat(g("clam").value)||0;
        const waste=(parseFloat(g("waste").value)||0)/100;
        const cFix=parseFloat(g("cfix").value)||0;
        const alpha=(parseFloat(g("alpha").value)||0)/100;
        const beta=(parseFloat(g("beta").value)||0)/100;
        const gamma=(parseFloat(g("gamma").value)||0)/100;
        const mwst=(parseFloat(g("mwst").value)||0)/100;

        const cMat=(A*(cFol+cLam))*(1+waste);
        const cArb=tmont*ch;
        const cRisk=(cMat+cArb+cFix)*alpha;
        const Pnet=(cMat+cArb+cFix+cRisk)*(1+beta)*(1+gamma);
        const Pbrut=Pnet*(1+mwst);

        return {tmont:round2(tmont),Cmat:round2(cMat),Carb:round2(cArb),Cfix:cFix,Crisk:round2(cRisk),Pnet:round2(Pnet),Pbrut:round2(Pbrut)};
      }

      function show(r){
        g("kNetto").textContent=r.Pnet.toFixed(2)+" €";
        g("kBrutto").textContent=r.Pbrut.toFixed(2)+" €";
        g("breakdown").textContent=`Zeit: ${r.tmont} h
Material: ${r.Cmat} €
Arbeit:   ${r.Carb} €
Fix:      ${r.Cfix} €
Risiko:   ${r.Crisk} €
-----------------
Netto:    ${r.Pnet} €
Brutto:   ${r.Pbrut} €`;
      }

      function copyQuote(r){
        const s=`KASCHEX – Kurzangebot
Netto:  ${r.Pnet} €
Brutto: ${r.Pbrut} €
Montagezeit: ${r.tmont} h
(Gültig nur mit schriftlichem Angebot)`;
        navigator.clipboard.writeText(s).catch(()=>{});
      }

      g("btnCalc").addEventListener("click",()=>show(compute()));
      g("btnQuote").addEventListener("click",()=>copyQuote(compute()));
      g("btnClear").addEventListener("click",()=>{
        ["area","rate","speed","tprep","ttravel","tmanual","cfolie","clam","waste","cfix","alpha","beta","gamma","mwst"].forEach(id=>g(id).value="");
        g("kNetto").textContent="– €";
        g("kBrutto").textContent="– €";
        g("breakdown").textContent="";
      });
      g("btnTime").addEventListener("click",()=>{
        g("tmanual").value=round2(estTime(parseFloat(g("area").value)||0,parseFloat(g("speed").value)||1,parseFloat(g("tprep").value)||0,parseFloat(g("ttravel").value)||0));
      });
      g("btnResetTime").addEventListener("click",()=>{g("tmanual").value="";});
    })();
  </script>
</body>
</html>
